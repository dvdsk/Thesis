\tikzstyle{tasks}=[base, rectangle, fill=skPurple!30]
\tikzstyle{task}=[base, rectangle, fill=skRed!30, font=\normalsize]
\tikzstyle{future}=[base, rectangle, fill=skRed!30, font=\normalsize]

\begin{tikzpicture}[node distance=0.5cm and 1.0cm, auto]
	\node (root) [task] {main function};

	\node (disc) [task, below=of root] {Discover new nodes};
	\node (succession) [task, below=of disc] {President succession};
		\node (sleep) [future, right=2 of succession] {sleep until timeout};
		\node (elect) [future, below=of sleep] {hold election};
		\node (found) [future, above=of sleep] {valid leader found};
		\node (died) [future, above=of found] {died};

	\node (praft) [task, below=of succession] {President Raft};

	\node (mraft) [task, below=of praft] {Minister Raft};
	\node (idle) [future, below=of mraft] {perform Idle role};
		\node (pres_orders) [future, right=2 of idle] {handle presidents orders};
		\node (redirect) [future, above=of pres_orders] {redirect clients};
			\node (handle_conn) [tasks, right=of redirect] {handle client connection};

	\node (clerk) [future, below=1.5 of idle] {perform clerk role};
		\node (min_orders) [future, right=of clerk] {handle minister orders};
		\node (client) [future, above=of min_orders] {handle client request};
			\node (handle_conn) [tasks, right=of client] {handle client connection};
		\node (pres_orders) [future, below=of min_orders] {handle presidents orders};

	\node (minister) [future, below=1.5 of clerk] {perform minister role};
		



	% \node (maintain_disc) [task, below left=of root] {discover nodes};
	%
	% \node (succesion) [task, below right=of root] {president succesion};
	% \node (handle_raft_pres) [base, right=of succesion] {president raft requests};
	% \begin{pgfonlayer}{background}
	% 	\node [fill=black!8, fit=(succesion) (handle_raft_pres)] {};
	% \end{pgfonlayer}
	%
	% \node (handle_raft_min) [base, below=of handle_raft_pres] {minister raft requests};
	% \begin{pgfonlayer}{background}
	% 	\node [fill=black!8, fit=(handle_raft_min)] {};
	% \end{pgfonlayer}
	%
	% \node (role) [base, below=of root] {role};
	% \node (idle) [base, below=of role] {idle};
	% \node (clerk) [base, below=of idle] {clerk};
	% \node (minister) [base, below=of clerk] {minister};
	% \node (president) [base, below=of minister] {president};


\end{tikzpicture}
